{%- assign repos = site.github.public_repositories
  | where_exp: "r", "r.fork == false"
  | where_exp: "r", "r.archived == false"
  | where_exp: "r", "r.disabled == false"
  | where_exp: "r", "r.name != site.github.repository_name"
  | sort: "pushed_at"
  | reverse
-%}

<ul class="repo-list">
  {%- for repo in repos -%}
    {%- assign owner = repo.owner.login -%}
    {%- assign branch = repo.default_branch | default: "main" -%}
    {%- capture zip_url -%}https://github.com/{{ owner }}/{{ repo.name }}/archive/refs/heads/{{ branch }}.zip{%- endcapture -%}

    <li class="repo-list-item">
      <a href="{{ repo.html_url }}">{{ repo.name }}</a>

      {%- if repo.description and repo.description != "" -%}
        <div class="repo-desc">{{ repo.description }}</div>
      {%- endif -%}

      <small class="repo-meta">
        {%- if repo.language -%}{{ repo.language }} · {%- endif -%} Updated {{ repo.pushed_at | date: "%Y-%m-%d" }} · {%- if repo.license and repo.license.spdx_id -%}{{ repo.license.spdx_id }} · {%- endif -%}
        <a href="{{ zip_url }}" rel="nofollow">Download</a>
      </small>
    </li>
  {%- endfor -%}
</ul>
